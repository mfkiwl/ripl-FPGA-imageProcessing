
img1 = imread RGB 512 512;

// phase 1: build feature space from input image
featureSpace = fold genarray(256,256,256) img1 ( \ arr (r,g,b) -> arr[r,g,b]++) ;

(peaksR,peaksG,peaksB) =
  fold
   (genarray(256,256,256)
   ,genarray(256,256,256)
   ,genarray(256,256,256))
   range(256,256,256)
   (\(peaksR,peaksG,peaksB) (i,j,k) -> undefined);


out img1;